<!DOCTYPE html>
<html lang="en" class="bg-gray-900 text-white font-sans">
<head>
  <meta charset="UTF-8">
  <title>TapeDrop Artists</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Space Grotesk', 'sans-serif']
          }
        }
      }
    }
  </script>
</head>
<body class="p-8">
  <h1 class="text-3xl font-bold mb-6">TapeDrop Artists</h1>
  <div id="artistList" class="space-y-4 text-white"></div>

  <script type="module">
    import PocketBase from 'https://cdn.jsdelivr.net/npm/pocketbase@0.18.4/+esm';

    const pb = new PocketBase("https://tapedrop.pockethost.io");

    async function loadArtists() {
      try {
        const records = await pb.collection('artist').getFullList({ expand: 'label', sort: 'name' });

        const list = document.getElementById('artistList');
        list.innerHTML = '';

        records.forEach(artist => {
          const labelName = artist.expand?.label?.name || 'Independent';

          const el = document.createElement('a');
          el.href = `artist.html?id=${artist.id}`;
          el.className = "block p-4 bg-gray-800 rounded hover:bg-gray-700";

          el.innerHTML = `
            <div class="text-xl font-semibold">${artist.name}</div>
            <div class="text-sm text-gray-400">${labelName}</div>
          `;

          list.appendChild(el);
        });
      } catch (err) {
        console.error('Error loading artists:', err);
        document.getElementById('artistList').innerText = 'Failed to load artists.';
      }
    }

    loadArtists();
  </script>
</body>
</html>
