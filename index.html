<!DOCTYPE html>
<html lang="en" class="bg-gray-900 text-white font-sans">
<head>
  <meta charset="UTF-8">
  <title>Welcome to TapeDrop</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Space Grotesk', 'sans-serif']
          }
        }
      }
    };
  </script>
</head>
<body class="p-8">
  <h1 class="text-3xl font-bold mb-4">TapeDrop Artists</h1>
  <div id="artist-list" class="space-y-4"></div>

  <!-- ✅ Load PocketBase as UMD (correct version) -->
  <script src="https://unpkg.com/pocketbase@0.18.4/dist/pocketbase.umd.js"></script>

  <!-- ✅ Inline script that uses PocketBase -->
  <script>
    const pb = new PocketBase("https://tapedrop.pockethost.io");

    async function loadArtists() {
      const container = document.getElementById("artist-list");
      try {
        const records = await pb.collection("artist").getFullList({
          expand: 'label',
          sort: 'name',
        });

        if (!records.length) {
          container.innerHTML = `<p class="text-gray-400">No artists found.</p>`;
          return;
        }

        records.forEach(artist => {
          const el = document.createElement("a");
          el.href = `artist.html?id=${artist.id}`;
          el.className = "block p-4 bg-gray-800 rounded hover:bg-gray-700 mb-2";
          el.innerHTML = `
            <div class="text-xl font-semibold">${artist.name}</div>
            <div class="text-sm text-gray-400">${artist.expand?.label?.name || 'Independent'}</div>
          `;
          container.appendChild(el);
        });
      } catch (err) {
        container.innerHTML = `<p class="text-red-400">Error loading artists: ${err.message}</p>`;
        console.error(err);
      }
    }

    loadArtists();
  </script>
</body>
</html>
